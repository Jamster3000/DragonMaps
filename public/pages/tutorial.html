<!DOCTYPE html>
<html lang="en">
<head>
  <title>DragonMaps | Tutorial</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../styles/main.css">
  <link rel="stylesheet" href="../styles/tutorial.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="../components/components.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", async function () {
        const tutorialContent = document.getElementById('tutorial-content');
        const tutorialTitle = document.getElementById('tutorial-title');
        
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        async function fetchMarkdownFile(filename) {
            const response = await fetch(`../tutorials/${filename}`);
            if (!response.ok) {
                throw new Error(`Error fetching ${filename}`);
            }
            return await response.text();
        }

        try {
            const file = getQueryParam('file');
            if (!file) {
                throw new Error('No file specified in query parameter.');
            }
            const markdown = await fetchMarkdownFile(file);
            const htmlContent = marked.parse(markdown);
            
            // Display title dynamically from the filename
            const title = file.split('-').slice(3).join(' ').replace('.md', '');
            if (tutorialTitle) {
                tutorialTitle.textContent = title;
            } else {
                console.error('Element with ID "tutorial-title" not found.');
            }
            
            tutorialContent.innerHTML = htmlContent;
        } catch (error) {
            console.error('Error loading tutorial:', error);
            tutorialContent.innerHTML = '<p>Sorry, this tutorial could not be loaded.</p>';
        }
    });
  </script>
</head>
<body>
  <div id="header-placeholder"></div>
  <main>
    <h1 id="tutorial-title"></h1>
    <div id="tutorial-content">
      <!-- Tutorial content will be injected here -->
    </div>
  </main>
  <div id="footer-placeholder"></div>
</body>
</html>
