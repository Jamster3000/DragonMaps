<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Create and share epic D&D battlemaps with DragonMaps. Design your maps with our easy-to-use online tool.">
  <title>DragonMaps - D&D Battlemap Creator</title>
  <link rel="stylesheet" href="../styles/main.css">
  <link rel="stylesheet" href="../styles/updates.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=MedievalSharp&family=Roboto:wght@400;700&display=swap">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="../components/components.js"></script>
</head>

<body>
  <div id="header-placeholder"></div>

  <div id="posts-container"></div>

  <div id="footer-placeholder"></div>

  <script>
        const postsContainer = document.getElementById('posts-container');

      async function fetchMarkdownFile(filename) {
          const response = await fetch(`../posts/${filename}`);
          return await response.text();
      }
      
      function extractDateFromFilename(filename) {
          const parts = filename.split('-');
          return new Date(parts[2], parts[1] - 1, parts[0]);
      }
      
      async function renderPosts() {
          const postFiles = ['19-8-2024-DragonMap Update.md', '24-7-2024-Welcome.md'];
          
          // Sort files by date (newest first)
          postFiles.sort((a, b) => extractDateFromFilename(b) - extractDateFromFilename(a));
      
          for (const file of postFiles) {
              try {
                  const markdown = await fetchMarkdownFile(file);
                  const html = marked.parse(markdown);
                  const postElement = document.createElement('div');
                  const date = extractDateFromFilename(file);
                  postElement.innerHTML = `
                      <div class="update-post-container">
                          <div class="post-date">${date.toLocaleDateString()}</div>
                          ${html}
                      </div>
                  `;
                  postsContainer.appendChild(postElement);
              } catch (error) {
                  console.error(`Error loading ${file}:`, error);
              }
          }
      }
      
      renderPosts();
    </script>
</body>
</html>
